%%================================
%% Definition of Utility Functions
%%================================
\makeatletter
\lispinterpl{%
%% map
(\define \map 
    (\lambda (\f.\l) (\@map@ \f \l ())))
(\define \@map@ (\lambda (\f \l \acc) (\lispif (\= \l ()) \acc (\@map@ \f (\cdr \l) (\cons (\apply \f (\car \l)) \acc)))))
%% @inner@map : ('a -> 'b) -> 'a list -> 'b list 
(\define \@inner@map 
    (\lambda (\f \l)
      (\lispif (\= () \l) () (\cons (\f (\car \l)) (\@inner@map \f (\cdr \l))))))
%% and : bool... -> bool
(\define \and 
   (\lambda \l 
     (\lispif (\= () \l) 
              /t
              (\lispif (\car \l) (\apply \and (\cdr \l)) /f))))
%% list
(\define \list (\lambda \x \x))
%% let bindings
(\defmacro \let 
  (\lambda (\binds \body)
    (\cons
        (\cons \lambda
           (\cons (\@inner@map \car \binds)
               (\cons \body ())))  
        (\@inner@map (\lambda (\x) (\car (\cdr \x))) \binds))))
}
\makeatother