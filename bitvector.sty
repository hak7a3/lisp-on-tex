\def\@bitvector@one{1}
\def\@bitvector@zero{0}

% create bitvector whose length is more than #2
% Control sequence #1 will be the result
\def\createbitvector#1#2{%
  \@tempcnta0
  \def#1{}%
  \@whilenum\@tempcnta<#2\do{%
    \expandafter\expandafter\expandafter\def
    \expandafter\expandafter\expandafter#1%
    \expandafter\expandafter\expandafter{%
      \expandafter#1\csname\the\@tempcnta\endcsname0}%
    \advance\@tempcnta1}}


% set bitvector #1's #2-th bit to #3
\def\setbitvector#1#2#3{%
  \begingroup
    \toks0\expandafter{\csname#2\endcsname}%
    \xdef\@bitvector@tmp{%
      \gdef\noexpand\@bitvector@set####1####2\the\toks0####3####4\relax{%
      \def####1{####2\the\toks0 #3####4}}}%
  \endgroup
  \@bitvector@tmp
  \expandafter\@bitvector@set\expandafter#1#1\relax
  \global\let\@bitvector@tmp\relax
  \global\let\@bitvector@set\relax}

% get bitvector #1's #2-th bit to #3
\def\getbitvector#1#2#3{%
  \begingroup
    \toks0\expandafter{\csname#2\endcsname}%
    \xdef\@bitvector@tmp{%
      \gdef\noexpand\@bitvector@get####1####2\the\toks0 ####3####4\relax{%
      \def####1{####3}}}%
  \endgroup
  \@bitvector@tmp
  \expandafter\@bitvector@get\expandafter#3#1\relax
  \global\let\@bitvector@tmp\relax
  \global\let\@bitvector@get\relax}
